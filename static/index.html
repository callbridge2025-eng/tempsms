<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Twilio SMS Viewer — Minimal</title>
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;max-width:900px;margin:24px auto;padding:0 12px}
header{display:flex;align-items:center;justify-content:space-between}
.msg{border:1px solid #ddd;padding:12px;border-radius:8px;margin:8px 0}
.meta{font-size:12px;color:#666;margin-bottom:6px}
#status{font-size:13px;color:#333}
button{padding:8px 12px;border-radius:6px;border:1px solid #bbb;background:#fff}
</style>
</head>
<body>
<header>
<h1>Twilio SMS Viewer</h1>
<div>
<span id="status">—</span>
<button id="refresh">Refresh</button>
</div>
</header>


<p>Incoming SMS to your Twilio numbers will appear below. Messages are stored in memory only; restarting the app clears them.</p>


<div id="messages"></div>


<script>
const messagesEl = document.getElementById('messages');
const statusEl = document.getElementById('status');
const refreshBtn = document.getElementById('refresh');


async function load(){
try{
statusEl.textContent = 'Loading...';
const res = await fetch('/messages');
if(!res.ok) throw new Error('HTTP ' + res.status);
const data = await res.json();
statusEl.textContent = data.length + ' messages';
render(data);
}catch(err){
statusEl.textContent = 'Error: ' + err.message;
}
}


function render(list){
messagesEl.innerHTML = '';
if(list.length === 0){
messagesEl.innerHTML = '<p><em>No messages yet.</em></p>';
return;
}
list.forEach(m => {
const div = document.createElement('div');
div.className = 'msg';
div.innerHTML = `
<div class="meta"><strong>From:</strong> ${escapeHtml(m.from || '')} &nbsp; <strong>To:</strong> ${escapeHtml(m.to || '')} &nbsp; <strong>At:</strong> ${escapeHtml(m.received_at || '')}</div>
<div>${escapeHtml(m.body || '')}</div>
<div style="margin-top:8px;font-size:12px;color:#888"><strong>SID:</strong> ${escapeHtml(m.message_sid || '')} — <strong>Media:</strong> ${m.num_media}</div>
`;
</html>
